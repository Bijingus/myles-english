$("#contact-form").submit(function(a){a.preventDefault();a={name:$("#contact-name").val(),email:$("#contact-email").val(),phone:$("#contact-phone").val(),subject:$("#contact-subject").val(),message:$("#contact-message").val()};$.post("ajax/contact.php",a,function(b){b=JSON.parse(b);if(!0===b.success){var c=$(".form-success");let d=$("#contact-form");c.css("height",d.height());d.fadeOut(1E3);c.delay(1E3).fadeIn()}else c=$(".form-alert"),c.html(b.message),setTimeout(function(){$(b.selector).delay(500).focus()},
500),c.fadeIn()})});$("#hs-form").submit(function(a){a.preventDefault();a={initials:$("#hs-initials").val(),score:player.points};$.post("ajax/submit-high-score.php",a,function(b){b=JSON.parse(b);if(!0===b.success)$("#hs-form").fadeOut(),$("#hs-form-success").delay(1E3).fadeIn();else{let c=$("#hs-form-alert");c.html(b.message);setTimeout(function(){$(b.selector).delay(500).focus()},500);c.fadeIn()}})});const rocketAttack=new Image;rocketAttack.src="images/sprites/player-attack-rocket.png";const laserAttack=new Image;laserAttack.src="images/sprites/player-attack-laser.png";const laserIdle=new Image;laserIdle.src="images/sprites/player-idle-laser.png";const rocketIdle=new Image;rocketIdle.src="images/sprites/player-idle-rocket.png";const batIdle=new Image;batIdle.src="images/sprites/bat-idle.png";const batAttack=new Image;batAttack.src="images/sprites/bat-attack.png";const shipIdle=new Image;
shipIdle.src="images/sprites/ship-idle.png";const shipAttack=new Image;shipAttack.src="images/sprites/ship-attack.png";const splat=new Image;splat.src="images/sprites/splat.png";const explosion=new Image;explosion.src="images/sprites/explosion.png";const mylesOffice=new Image;mylesOffice.src="images/buildings/myles-office.png";const protonOffice=new Image;protonOffice.src="images/buildings/proton-office.png";const jstBuilding=new Image;jstBuilding.src="images/buildings/jst-building.png";
const iconOilOffice=new Image;iconOilOffice.src="images/buildings/icon-oil-office.png";const ionOffice=new Image;ionOffice.src="images/buildings/ioncpa-office.png";const cloudImg=new Image;cloudImg.src="images/cloud-1.png";const hillImg=new Image;hillImg.src="images/hill-1.png";const treeImg=new Image;treeImg.src="images/tree.png";const groundImg=new Image;groundImg.src="images/ground-tile-grass.png";const plantImg=new Image;plantImg.src="images/plant-1.png";const rockImg=new Image;rockImg.src="images/rock-large.png";
const healthImg=new Image;healthImg.src="images/powerup-health.png";const attackPowerupImg=new Image;attackPowerupImg.src="images/powerup-attacks.png";const acidProjectileImg=new Image;acidProjectileImg.src="images/acid-projectile.png";const photonProjectileImg=new Image;photonProjectileImg.src="images/photon-projectile.png";const laserProjectileImg=new Image;laserProjectileImg.src="images/laser-projectile.png";const rocketProjectileImg=new Image;rocketProjectileImg.src="images/rocket-projectile.png";
const smokeDarkImg=new Image;smokeDarkImg.src="images/smoke-particle-dark.png";const smokeImg=new Image;smokeImg.src="images/smoke-particle.png";const sparkImg=new Image;sparkImg.src="images/spark-particle.png";const lightDebrisImg=new Image;lightDebrisImg.src="images/debris-light.png";const darkDebrisImg=new Image;darkDebrisImg.src="images/debris-dark.png";const bubbleImg=new Image;bubbleImg.src="images/bubble-particle.png";const fishIdleLeftImg=new Image;fishIdleLeftImg.src="images/sprites/fish-idle.png";
const fishIdleRightImg=new Image;fishIdleRightImg.src="images/sprites/fish-idle-right.png";const fishGreenIdleLeftImg=new Image;fishGreenIdleLeftImg.src="images/sprites/fish-green-idle.png";const fishGreenIdleRightImg=new Image;fishGreenIdleRightImg.src="images/sprites/fish-green-idle-right.png";const fishYellowIdleLeftImg=new Image;fishYellowIdleLeftImg.src="images/sprites/fish-yellow-idle.png";const fishYellowIdleRightImg=new Image;fishYellowIdleRightImg.src="images/sprites/fish-yellow-idle-right.png";
const submarineImg=new Image;submarineImg.src="images/sprites/submarine.png";function randomizeCoord(a){return 2*Math.round(Math.random())-1}function randomIntFromInterval(a,b){return Math.floor(Math.random()*(b-a+1)+a)}function isCollide(a,b){return!(a.y+a.h<b.y||a.y>b.y+b.h||a.x+a.w<b.x||a.x>b.x+b.w)}function doBrainAndDraw(a){for(var b=0;b<a.length;b++)a[b].brain();for(b=0;b<a.length;b++)a[b].draw()}
function randomPowerup(a,b){let c=randomIntFromInterval(1,15);1===c&&2>weapons.projectileSpawnRate&&powerups.push(new attackCount(a,b));2<c&&5>c&&powerups.push(new hp(a,b))}function resizeVideo(a=".video"){$(a).each(function(){let b=$(this).parent().width(),c=.5625*b;$(this).width(b);$(this).height(c)})}
function elementInView(a){let b=a.offsetHeight,c=a.offsetWidth;a=a.getBoundingClientRect();return a.top>=-b&&a.left>=-c&&a.right<=(window.innerWidth||document.documentElement.clientWidth)+c&&a.bottom<=(window.innerHeight||document.documentElement.clientHeight)+b?!0:!1}
function getDeviceType(){const a=navigator.userAgent;return/(tablet|ipad|playbook|silk)|(android(?!.*mobi))/i.test(a)||/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Kindle|Silk-Accelerated|(hpw|web)OS|Opera M(obi|ini)/.test(a)?"mobile":"desktop"}
function resetHero(){$(".hero-content h5, .hero-content h1, .hero-content button").css("display","inline-block");$(".hero-content .ui-tooltip").css("display","block");anime({targets:".hero-content h5",translateX:"0",opacity:1,easing:"easeInOutQuad"});anime({targets:".hero-content h1",translateX:"0",opacity:1,easing:"easeInOutQuad"});anime({targets:".hero-content .ui-tooltip, .hero-content button",opacity:1,easing:"easeInOutQuad"})};const canvas=document.querySelector("#canvas"),ctx=canvas.getContext("2d"),wrapper=document.querySelector(".game-wrapper");wrapper.width=window.innerWidth;wrapper.height=window.innerHeight;canvas.height=wrapper.height;canvas.width=wrapper.width;resizeVideo();$(window).resize(function(){wrapper.width=window.innerWidth;wrapper.height=window.innerHeight;canvas.height=wrapper.height;canvas.width=wrapper.width;resizeVideo()});const canvasWater=document.querySelector("#canvas-water"),ctxWater=canvasWater.getContext("2d");
canvasWater.height=$("#water-wrapper").outerHeight();canvasWater.width=$("#water-wrapper").outerWidth();$(window).resize(function(){canvasWater.height=$("#water-wrapper").outerHeight();canvasWater.width=$("#water-wrapper").outerWidth();world.objects.forEach((a,b)=>{"cloud"!==a.type&&"ground"!==a.type&&(a.y=window.innerHeight-a.h-data.groundH);"ground"===a.type&&(a.y=window.innerHeight-a.h)})});const deviceType=getDeviceType();let scale=1;1366>window.innerWidth&&(scale=.75);980>window.innerWidth&&(scale=.5);const data={id:0,frame:0,currentEvent:0,eventTimer:0,continueEvents:!0,gamePause:!1,gameComplete:!1,waterPause:!0,scale};data.groundH=128*data.scale;var projectiles=[],enemies=[],effects=[],powerups=[];class Particles{constructor(a){data.id+=1;this.id=data.id;this.type="particles";this.ctx=a.ctx;this.particles=[];this.x=a.hasOwnProperty("x")?a.x:0;this.y=a.hasOwnProperty("y")?a.y:0;this.w=a.hasOwnProperty("w")?a.w:32;this.h=a.hasOwnProperty("h")?a.h:32;this.gravity=a.hasOwnProperty("gravity")?a.gravity:0;this.drag=a.hasOwnProperty("drag")?a.drag:0;this.minRandX=a.hasOwnProperty("minRandX")?a.minRandX:0;this.maxRandX=a.hasOwnProperty("maxRandX")?a.maxRandX:0;this.minRandY=a.hasOwnProperty("minRandY")?
a.minRandY:0;this.maxRandY=a.hasOwnProperty("maxRandY")?a.maxRandY:0;this.velocityX=a.hasOwnProperty("velocityX")?a.velocityX:0;this.velocityY=a.hasOwnProperty("velocityY")?a.velocityY:0;this.randomVelocity=a.hasOwnProperty("randomVelocity")?a.randomVelocity:0;this.spawnRate=a.hasOwnProperty("spawnRate")?a.spawnRate:1;this.spawnChance=a.hasOwnProperty("spawnChance")?a.spawnChance:100;this.decayRate=a.hasOwnProperty("decayRate")?a.decayRate:.4;this.lifespan=a.hasOwnProperty("lifespan")?a.lifespan:
120;this.timer=a.hasOwnProperty("timer")?a.timer:!1;this.img=a.hasOwnProperty("img")?a.img:sparkImg}brain(a=null,b=null){null!==a&&(this.x=a);null!==b&&(this.y=b);if((0<this.timer||!1===this.timer)&&1===randomIntFromInterval(1,Math.floor(100/this.spawnChance)))if(1>this.spawnRate)0===data.frame*this.spawnRate%1&&this.particles.push(this.spawn());else for(a=0;a<this.spawnRate;a++)this.particles.push(this.spawn());a=[];for(b=0;b<this.particles.length;b++)--this.particles[b].timer,this.particles[b].x+=
this.velocityX,this.particles[b].y+=this.velocityY,this.particles[b].velocityY+=this.gravity,this.particles[b].x+=this.particles[b].velocityX,this.particles[b].y+=this.particles[b].velocityY,this.particles[b].x-=randomIntFromInterval(this.minRandX,this.maxRandX),this.particles[b].y-=randomIntFromInterval(this.minRandY,this.maxRandY),this.particles[b].w=0>=this.particles[b].w?0:this.particles[b].w-=this.decayRate,this.particles[b].h=0>=this.particles[b].h?0:this.particles[b].h-=this.decayRate,0>=this.particles[b].timer&&
a.push(b);for(b=0;b<a.length;b++)this.particles.splice(a[b],1);0>=this.timer&&0>=this.particles.length?this.remove():!1!==this.timer&&--this.timer}spawn(){return{x:this.x-=randomIntFromInterval(this.minRandX,this.maxRandX),y:this.y-=randomIntFromInterval(this.minRandY,this.maxRandY),w:this.w,h:this.h,velocityX:randomIntFromInterval(-1*this.randomVelocity,this.randomVelocity),velocityY:randomIntFromInterval(-1*this.randomVelocity,this.randomVelocity),timer:this.lifespan}}remove(){const a=effects.findIndex(b=>
b.id===this.id);effects.splice(a,1)}draw(){for(let a=0;a<this.particles.length;a++)if(Array.isArray(this.img))for(let b=0;b<this.img.length;b++)0===a%(b+2)&&this.ctx.drawImage(this.img[b],this.particles[a].x,this.particles[a].y,this.particles[a].w,this.particles[a].h);else this.ctx.drawImage(this.img,this.particles[a].x,this.particles[a].y,this.particles[a].w,this.particles[a].h)}};const weapons={projectileSpawnRate:1,laser:{type:"laser",timeToRound:0,loaded:!0,attackSpeed:10,attack:5},rocket:{timeToRound:0,type:"rocket",loaded:!0,attackSpeed:50,attack:30}};let args={ctx,minRandX:-1*data.scale,maxRandX:5*data.scale,minRandY:2*data.scale,maxRandY:-5*data.scale,x:0,y:0,w:12*data.scale,h:12*data.scale,spawnRate:2,decayRate:.3,lifespan:64,timer:!1,gravity:.1,img:smokeImg};
const playerSmoke=new Particles(args),player={startingLives:2,lives:2,hp:100,points:0,invincible:!1,state:"idle",projectiles:[],weapon:weapons.laser,w:55*data.scale,h:110*data.scale,y:window.innerHeight/2,x:60,maxSpeed:9*data.scale,acceleration:.75,velocityX:0,velocityY:0,img:new Image,spriteCount:0,respawnTimer:120,respawnLength:120,reset:function(){player.lives=player.startingLives;player.respawnTimer=player.respawnLength;player.hp=100;player.state="idle";player.invincible=!1;player.spriteCount=
0},move:function(){"mobile"===deviceType?player.moveMobile():player.moveDesktop()},moveDesktop:function(){let a=mouse.x-player.x-player.w/2-10,b=mouse.y-player.y-player.h/2,c=Math.sqrt(a*a+b*b);c>=player.maxSpeed&&(player.velocityX=Math.floor(a/c*player.maxSpeed),player.y>window.innerHeight-256*data.scale&&mouse.y>window.innerHeight-256*data.scale?player.y=window.innerHeight-256*data.scale:player.velocityY=player.y>window.innerHeight-256*data.scale&&mouse.y<=window.innerHeight-256*data.scale?player.velocityY-
player.maxSpeed:Math.floor(b/c*player.maxSpeed),player.x+=player.velocityX,player.y+=player.velocityY)},moveMobile:function(){player.velocityX=player.maxSpeed*joy.x;player.velocityY=player.maxSpeed*joy.y;0<=player.x&&player.x+player.w<=window.innerWidth&&(player.x+=player.velocityX);0<=player.y&&player.y+player.h<=window.innerHeight&&(player.y-=player.velocityY);0>player.x&&(player.x=0);player.x+player.w>window.innerWidth&&(player.x=window.innerWidth-player.w);0>player.y&&(player.y=0);player.y+player.h>
window.innerHeight-data.groundH&&(player.y=window.innerHeight-player.h-data.groundH)},draw:function(){player.logic();"dead"!==player.state&&(playerSmoke.draw(),playerSmoke.brain(player.x+35*data.scale,player.y+player.h/2));if("dead"===player.state&&0===data.frame%6&&60>player.respawnTimer||"idle"===player.state&&"laser"===player.weapon.type)ctx.drawImage(laserIdle,110*player.spriteCount,0,110,220,player.x,player.y,110*data.scale,220*data.scale),3===player.spriteCount?player.spriteCount=0:0===data.frame%
6&&player.spriteCount++;"idle"===player.state&&"rocket"===player.weapon.type&&(ctx.drawImage(rocketIdle,110*player.spriteCount,0,110,220,player.x,player.y,110*data.scale,220*data.scale),3===player.spriteCount?player.spriteCount=0:0===data.frame%6&&player.spriteCount++);"attack"===player.state&&"rocket"===player.weapon.type&&(ctx.drawImage(rocketAttack,110*player.spriteCount,0,110,220,player.x,player.y,110*data.scale,220*data.scale),8===player.spriteCount?(player.spriteCount=0,!1===mouse.down&&"desktop"===
deviceType&&(player.state="idle")):0===data.frame%6&&player.spriteCount++);"attack"===player.state&&"laser"===player.weapon.type&&(ctx.drawImage(laserAttack,110*player.spriteCount,0,110,220,player.x,player.y,110*data.scale,220*data.scale),3===player.spriteCount?(player.spriteCount=0,!1===mouse.down&&"desktop"===deviceType&&(player.state="idle")):0===data.frame%2&&player.spriteCount++)},logic:function(){if("attack"===player.state){if("laser"===player.weapon.type&&0===data.frame%player.weapon.attackSpeed)for(var a=
0;a<weapons.projectileSpawnRate;a++){var b=new laserProjectile;2===weapons.projectileSpawnRate&&(b.y=1===a?b.y-30*data.scale:b.y+30*data.scale);player.projectiles.push(b)}if("rocket"===player.weapon.type&&0===player.weapon.timeToRound)for(a=0;a<weapons.projectileSpawnRate;a++)b=new rocketProjectile,2===weapons.projectileSpawnRate&&(b.y=1===a?b.y-30*data.scale:b.y+30*data.scale),player.projectiles.push(b);0===player.weapon.timeToRound&&(player.weapon.timeToRound=player.weapon.attackSpeed)}0<player.weapon.timeToRound&&
--player.weapon.timeToRound;0>=player.hp&&(player.state="dead");player.respawnTimer===player.respawnLength&&"dead"===player.state&&(effects.push(new Particles({ctx,minRandX:0,maxRandX:0,minRandY:0,maxRandY:0,velocityX:0,velocityY:0,randomVelocity:15,x:player.x,y:player.y+player.h/2,w:64*data.scale,h:64*data.scale,spawnRate:50,decayRate:2,lifespan:120,timer:2,gravity:0})),player.sound("fail"));"dead"===player.state&&(--player.respawnTimer,player.y=window.innerHeight/2-player.h/2,player.x=120*data.scale,
player.invincible=!0,0===player.lives&&60===player.respawnTimer&&(resetHero(),$(".ui").animate({opacity:0}),world.reset(),player.reset(),(new bootstrap.Modal(document.getElementById("hs-modal"),{keyboard:!1})).show(),$(".speech-bubble-wrapper").hide(),level1Music.stop()),0===player.respawnTimer&&0<player.points&&(player.points-=50,0>player.points&&(player.points=0)),0===player.respawnTimer&&0<player.lives&&(player.hp=100,--player.lives,player.weapon=weapons.laser,player.respawnTimer=player.respawnLength,
weapons.projectileSpawnRate=1,player.sound("respawn"),player.invincible=!1,player.state="idle"))},speak:function(a,b=!0){!0===b&&(new Howl({src:["sounds/effects/speech-bubble.wav"],volume:.5})).play();b=document.querySelector(".speech-bubble-wrapper");const c=document.querySelector(".speech-bubble");b.style.display="block";b.style.top=player.y+"px";b.style.left=player.x+player.w+60+"px";c.innerHTML=a},sound:function(a="oof"){if("oof"===a){var b=new Howl({src:["sounds/effects/player-oof.wav"]});b.play()}"fail"===
a&&(b=new Howl({src:["sounds/effects/player-fail.wav"]}),b.play());"respawn"===a&&(b=new Howl({src:["sounds/effects/player-respawn.wav"]}),b.play())}};const mouse={x:null,y:null,down:!1},joy={x:null,y:null,attack:!1};
if("mobile"===deviceType){var options={zone:document.querySelector(".joystick")},manager=nipplejs.create(options);manager.on("move",function(a,b){joy.x=b.vector.x;joy.y=b.vector.y});manager.on("start",function(a,b){joy.attack=!0;player.state="attack"});manager.on("end",function(){joy.x=0;joy.y=0;joy.attack=!1;player.state="idle";player.spriteCount=0})}else document.querySelector(".game-wrapper").addEventListener("mousemove",function(a){mouse.x=a.pageX;mouse.y=a.pageY}),document.querySelector(".game-wrapper").addEventListener("mousedown",
function(a){mouse.down=!0;player.spriteCount=0;player.state="attack"}),document.addEventListener("mouseup",function(a){mouse.down=!1});
document.addEventListener("keydown",function(a){!0!==data.gameComplete&&(49!==a.keyCode&&50!==a.keyCode||(new Howl({src:["sounds/effects/weapon-change.wav"]})).play(),49===a.keyCode&&(player.weapon=weapons.laser,player.spriteCount=0,document.querySelector(".ui-weapon-laser").classList.add("ui-button-active"),document.querySelector(".ui-weapon-rocket").classList.remove("ui-button-active")),50===a.keyCode&&(player.weapon=weapons.rocket,player.spriteCount=0,document.querySelector(".ui-weapon-rocket").classList.add("ui-button-active"),
document.querySelector(".ui-weapon-laser").classList.remove("ui-button-active")))});class acidProjectile{constructor(){data.id+=1;this.id=data.id;this.type="acid";this.velocityX=7;this.velocityY=0;this.acceleration=-.2;this.maxSpeed=-12*data.scale;this.attack=10;this.gravity=.02;this.y=this.x=0;this.w=36*data.scale;this.h=16*data.scale}brain(){0>this.x-this.w?this.remove():(this.velocityX>this.maxSpeed&&(this.velocityX-=this.acceleration),this.velocityY+=this.gravity,this.x-=this.velocityX,this.y+=this.velocityY,this.collisions())}collisions(){isCollide(player,this)&&!0!==player.invincible&&
(player.hp-=this.attack,this.remove(),player.sound("oof"))}remove(){const a=projectiles.findIndex(b=>b.id===this.id);projectiles.splice(a,1)}draw(){ctx.drawImage(acidProjectileImg,this.x,this.y,this.w,this.h)}sound(){(new Howl({src:["sounds/effects/bat-attack.wav"],volume:.3})).play()}}
class photonProjectile{constructor(){data.id+=1;this.id=data.id;this.type="photon";this.velocityX=7;this.velocityY=0;this.acceleration=-.1;this.maxSpeed=-9*data.scale;this.attack=15;this.y=this.x=0;this.w=32*data.scale;this.h=32*data.scale}brain(){0>this.x-this.w?this.remove():(this.velocityX>this.maxSpeed&&(this.velocityX-=this.acceleration),this.x-=this.velocityX,this.y+=this.velocityY,this.collisions())}collisions(){isCollide(player,this)&&!0!==player.invincible&&(player.hp-=this.attack,this.remove(),
player.sound("oof"))}remove(){const a=projectiles.findIndex(b=>b.id===this.id);projectiles.splice(a,1)}draw(){ctx.drawImage(photonProjectileImg,this.x,this.y,this.w,this.h)}sound(){(new Howl({src:["sounds/effects/photon.wav"],volume:.3})).play()}}
class laserProjectile{constructor(){data.id+=1;this.id=data.id;this.type="laser";this.drag=0;this.velocityX=25*data.scale;this.acceleration=5;this.maxSpeed=150;this.attack=1===weapons.projectileSpawnRate?weapons.laser.attack:.65*weapons.laser.attack;this.x=player.x+player.w;this.y=player.y+player.h/2-7;this.w=184*data.scale;this.h=32*data.scale;this.sound()}brain(){this.x+this.w>window.innerWidth?this.remove():(this.velocityX<this.maxSpeed&&(this.velocityX+=this.acceleration),this.x+=this.velocityX,
this.collisions())}collisions(){for(let a=0;a<enemies.length;a++)if(isCollide(this,enemies[a])){enemies[a].hp-=this.attack;effects.push(new Particles({ctx,minRandX:0,maxRandX:0,minRandY:0,maxRandY:0,velocityX:0,velocityY:0,randomVelocity:15,x:this.x+this.w,y:this.y+this.h/2,w:16,h:16,spawnRate:15,decayRate:1,lifespan:16,timer:1,gravity:2}));this.remove();break}}remove(){const a=player.projectiles.findIndex(b=>b.id===this.id);player.projectiles.splice(a,1)}draw(){ctx.drawImage(laserProjectileImg,this.x,
this.y,this.w,this.h)}sound(){(new Howl({src:["sounds/effects/laser.wav"],volume:.85})).play()}}
class rocketProjectile{constructor(){data.id+=1;let a={ctx,minRandX:2.5,maxRandX:-2.5,minRandY:-2.5,maxRandY:2.5,w:8*data.scale,h:8*data.scale,spawnRate:3,decayRate:.15,lifespan:80,gravity:.05,img:smokeDarkImg};this.id=data.id;this.particles=new Particles(a);this.type="rocket";this.velocityX=3;this.velocityY=0;this.acceleration=.2;this.maxSpeed=20*data.scale;this.drag=10;this.gravity=.02;this.attackSpeed=weapons.rocket.attackSpeed;this.attack=weapons.rocket.attack;this.x=player.x+player.w;this.y=
player.y+player.h/2;this.w=24*data.scale;this.h=12*data.scale;this.sound()}brain(){this.x+this.w>window.innerWidth+1200?this.remove():(this.velocityX<this.maxSpeed&&(this.velocityX+=this.acceleration),this.velocityY+=this.gravity,this.x+=this.velocityX,this.y+=this.velocityY,this.collisions())}remove(){const a=player.projectiles.findIndex(b=>b.id===this.id);player.projectiles.splice(a,1)}collisions(){for(let a=0;a<enemies.length;a++)isCollide(this,enemies[a])&&(this.remove(),enemies[a].hp-=this.attack,
effects.push(new effect("explosion",enemies[a].x,enemies[a].y)))}draw(){this.particles.brain(this.x-10,this.y+3);this.particles.draw();ctx.drawImage(rocketProjectileImg,this.x,this.y,this.w,this.h)}sound(){(new Howl({src:["sounds/effects/rocket-launch.wav"],volume:.7})).play()}};class hp{constructor(a,b){data.id+=1;this.id=data.id;this.w=32*data.scale;this.h=32*data.scale;this.x=a;this.y=b;this.animate="grow";this.sound("drop")}brain(){isCollide(this,player)&&!1===player.invincible&&(player.hp+=20,this.remove(),this.sound())}remove(){const a=powerups.findIndex(b=>b.id===this.id);powerups.splice(a,1)}draw(){this.w===32*data.scale&&(this.animate="grow");this.w===48*data.scale&&(this.animate="shrink");"grow"===this.animate&&(this.w+=1,this.h+=1,this.y-=.5,this.x-=.5);"shrink"===
this.animate&&(--this.w,--this.h,this.y+=.5,this.x+=.5);ctx.drawImage(healthImg,this.x,this.y,this.w,this.h);this.x-=5*data.scale}sound(a="collect"){if("collect"===a){var b=new Howl({src:["sounds/effects/powerup-collect.wav"]});b.play()}"drop"===a&&(b=new Howl({src:["sounds/effects/powerup-drop.wav"]}),b.play())}}
class attackCount{constructor(a,b){data.id+=1;this.id=data.id;this.w=32*data.scale;this.h=32*data.scale;this.x=a;this.y=b;this.animate="grow";this.sound("drop")}brain(){isCollide(this,player)&&!1===player.invincible&&(2>weapons.projectileSpawnRate&&(weapons.projectileSpawnRate+=1),this.remove(),this.sound())}sound(a="collect"){"collect"===a&&(new Howl({src:["sounds/effects/powerup-collect.wav"]})).play()}remove(){const a=powerups.findIndex(b=>b.id===this.id);powerups.splice(a,1)}draw(){32===this.w&&
(this.animate="grow");48===this.w&&(this.animate="shrink");"grow"===this.animate&&(this.w+=1,this.h+=1,this.y-=.5,this.x-=.5);"shrink"===this.animate&&(--this.w,--this.h,this.y+=.5,this.x+=.5);ctx.drawImage(attackPowerupImg,this.x,this.y,this.w,this.h);this.x-=5*data.scale}};class Bat{constructor(a=null,b=null){data.id+=1;this.id=data.id;this.state="idle";this.attack=10;this.health=16*data.scale;this.hp=16*data.scale;this.points=10;this.velocity=-3.5*data.scale;this.attackVelocity=10;this.attackSpeed=60;this.w=67*data.scale;this.h=60*data.scale;this.x=null===a?window.innerWidth:a;this.y=null===b?randomIntFromInterval(0,window.innerHeight):b;this.spriteCount=0;this.timer=this.timerLength=60;this.rand=0}trackPlayer(){this.y<player.y+player.h/2&&(this.y+=2*data.scale,this.x-=
1*data.scale);this.y>player.y+player.h/2&&(this.y-=2*data.scale,this.x-=1*data.scale)}die(){player.points+=this.points;effects.push(new effect("splat",this.x,this.y));randomPowerup(this.x,this.y);this.remove();this.sound("die")}remove(){const a=enemies.findIndex(b=>b.id===this.id);enemies.splice(a,1)}brain(){this.x+=this.velocity;this.x<0-this.w?this.remove():0>=this.hp?this.die():(this.timer===this.timerLength&&(this.rand=this.y>window.innerHeight-300?5:128>this.y?12:randomIntFromInterval(0,10)),
--this.timer,0===this.timer&&(this.timer=this.timerLength),2>=this.rand?this.y+=2*data.scale:3<=this.rand&&6>this.rand?this.y-=2*data.scale:this.trackPlayer(),0===data.frame%47&&(this.state="attack",this.shoot(),this.spriteCount=0),16===data.frame%47&&(this.spriteCount=0,this.state="idle"),15>=data.frame%47&&(this.state="attack"))}shoot(){let a=new acidProjectile;a.x=this.x-15;a.y=this.y+this.h/2+15;projectiles.push(a);a.sound()}draw(){var a=this.hp/this.health*100;var b=66<=a?"#5edc76ff":66>a&&33<
a?"#f6ef3bff":"#f22122ff";ctx.strokeStyle=b;ctx.fillStyle=b;b=this.w;a=Math.floor(a/100*b);ctx.strokeRect(this.x,this.y-20,b,4);ctx.fillRect(this.x,this.y-20,a,4);ctx.stroke();"idle"===this.state&&(ctx.drawImage(batIdle,67*this.spriteCount,0,67,60,this.x,this.y,67*data.scale,60*data.scale),4===this.spriteCount?this.spriteCount=0:0===data.frame%3&&this.spriteCount++);"attack"===this.state&&(ctx.drawImage(batAttack,67*this.spriteCount,0,67,60,this.x,this.y,67*data.scale,60*data.scale),3===this.spriteCount?
this.spriteCount=0:0===data.frame%8&&this.spriteCount++)}sound(a="attack"){"die"===a&&(new Howl({src:["sounds/effects/bat-die.wav"]})).play()}};class Ship{constructor(a=null,b=null){data.id+=1;this.id=data.id;this.state="idle";this.attack=15;this.health=34*data.scale;this.hp=34*data.scale;this.points=20;this.vx=-6*data.scale;this.vy=3*data.scale;this.attackVelocity=7;this.attackSpeed=120;this.w=67*data.scale;this.h=60*data.scale;this.x=null===a?window.innerWidth:a;this.y=null===b?randomIntFromInterval(0,window.innerHeight):b;this.spriteCount=0;this.timer=this.timerLength=60;this.rand=randomIntFromInterval(0,10);5>this.rand&&(this.direction=
"down");5<=this.rand&&(this.direction="up")}die(){player.points+=this.points;this.remove();effects.push(new Particles({ctx,minRandX:1,maxRandX:1,minRandY:1,maxRandY:1,velocityX:0,velocityY:0,randomVelocity:15,x:this.x+this.w/2,y:this.y+this.h/2,w:30,h:32,spawnRate:8,decayRate:1,lifespan:64,timer:1,gravity:1,img:[lightDebrisImg,darkDebrisImg]}));this.sound("die")}remove(){const a=enemies.findIndex(b=>b.id===this.id);enemies.splice(a,1)}brain(){0>=this.hp?this.die():this.x<0-this.w?this.remove():(this.y>=
window.innerHeight-256&&(this.direction="up"),128>=this.y&&(this.direction="down"),"down"===this.direction&&(this.y+=this.vy),"up"===this.direction&&(this.y-=this.vy),this.x+=this.vx,this.state="idle",85>=data.frame%150&&(this.state="attack",0===data.frame%14&&8<data.frame%150&&this.shoot()),"idle"===this.state&&(this.spriteCount=0))}shoot(){let a=new photonProjectile;a.x=this.x-15;a.y=this.y+this.h/2+15;projectiles.push(a);a.sound()}draw(){var a=this.hp/this.health*100;var b=66<=a?"#5edc76ff":66>
a&&33<a?"#f6ef3bff":"#f22122ff";ctx.strokeStyle=b;ctx.fillStyle=b;b=this.w;a=Math.floor(a/100*b);ctx.strokeRect(this.x,this.y-20,b,4);ctx.fillRect(this.x,this.y-20,a,4);ctx.stroke();"idle"===this.state&&(ctx.drawImage(shipIdle,93*this.spriteCount,0,93,64,this.x,this.y,93*data.scale,64*data.scale),0===this.spriteCount?this.spriteCount=0:0===data.frame%3&&this.spriteCount++);"attack"===this.state&&(ctx.drawImage(shipAttack,93.33*this.spriteCount,0,93.33,64,this.x,this.y,93.33*data.scale,64*data.scale),
14===this.spriteCount?this.spriteCount=0:0===data.frame%6&&this.spriteCount++)}sound(a="attack"){"die"===a&&(new Howl({src:["sounds/effects/ship-die.wav"]})).play()}};class Fish{constructor(a,b){data.id+=1;let c=randomIntFromInterval(1,3);this.color=1===c?"purple":2===c?"yellow":"green";this.bubbles=new Particles({ctx:ctxWater,minRandX:0,maxRandX:0,minRandY:0,maxRandY:0,velocityY:-.5,x:a,y:b,w:16,h:16,spawnRate:.15,spawnChance:15,decayRate:.03,lifespan:640,timer:!1,gravity:-.01,img:bubbleImg});this.id=data.id;this.state="idle";this.attack=0;this.hp=this.health=15;this.points=0;this.accelerationY=this.accelerationX=.1;this.vy=this.vx=0;this.maxVX=randomIntFromInterval(2,
8);this.maxVY=randomIntFromInterval(2,8);this.attackSpeed=this.attackVelocity=0;this.w=64;this.h=42;this.x=a;this.y=b;this.spriteCount=0;this.timer=this.timerLength=60;this.rand=0}trackMouse(){0>=this.y&&(this.vy+=1);this.y>=canvasWater.height&&--this.vy;0>=this.x&&(this.vx+=1);this.x>=canvasWater.width&&--this.vx;this.x<mouse.x&&(this.vx<this.maxVX&&(this.vx+=this.accelerationX),this.x+=this.vx);this.x>mouse.x&&(this.vx>-1*this.maxVX&&(this.vx-=this.accelerationX),this.x+=this.vx);this.y<mouse.y&&
(this.vy<this.maxVY&&(this.vy+=this.accelerationY),this.y+=this.vy);this.y>mouse.y&&(this.vy>-1*this.maxVY&&(this.vy-=this.accelerationY),this.y+=this.vy)}brain(){this.bubbles.brain(this.x,this.y);this.trackMouse()}draw(){if("idle"===this.state){let a=this.w,b=this.h,c;"purple"===this.color?c=0<this.vx?fishIdleRightImg:fishIdleLeftImg:"yellow"===this.color?c=0<this.vx?fishYellowIdleRightImg:fishYellowIdleLeftImg:"green"===this.color&&(c=0<this.vx?fishGreenIdleRightImg:fishGreenIdleLeftImg);ctxWater.drawImage(c,
a*this.spriteCount,0,a,b,this.x,this.y,a,b);this.bubbles.draw();3===this.spriteCount?this.spriteCount=0:0===data.frame%3&&this.spriteCount++}}};class Submarine{constructor(a,b){data.id+=1;this.id=data.id;this.state="idle";this.attack=0;this.hp=this.health=15;this.points=0;this.accelerationY=this.accelerationX=.02;this.vy=this.vx=0;this.maxVY=this.maxVX=1;this.attackSpeed=this.attackVelocity=0;this.w=256;this.h=169;this.x=a;this.y=b;this.spriteCount=0;this.timer=this.timerLength=60;this.rand=0;this.bubbles=new Particles({ctx:ctxWater,minRandX:-2,maxRandX:2,minRandY:-2,maxRandY:2,velocityY:-.5,velocityX:3,x:a,y:b,w:16,h:16,spawnRate:1,decayRate:.1,
lifespan:240,timer:!1,gravity:-.01,img:bubbleImg})}trackMouse(){this.x<mouse.x&&(this.vx<this.maxVX&&(this.vx+=this.accelerationX),this.x+=this.vx);this.x>mouse.x&&(this.vx>-1*this.maxVX&&(this.vx-=this.accelerationX),this.x+=this.vx);this.y<mouse.y&&(this.vy<this.maxVY&&(this.vy+=this.accelerationY),this.y+=this.vy);this.y>mouse.y&&(this.vy>-1*this.maxVY&&(this.vy-=this.accelerationY),this.y+=this.vy)}brain(){this.bubbles.brain(this.x+this.w,this.y+110);this.trackMouse()}draw(){if("idle"===this.state){let a=
this.w,b=this.h;ctxWater.drawImage(submarineImg,a*this.spriteCount,0,a,b,this.x,this.y,a,b);this.bubbles.draw();5===this.spriteCount?this.spriteCount=0:0===data.frame%2&&this.spriteCount++}}};class cloud{constructor(){this.type="cloud";this.w=200*data.scale;this.h=120*data.scale;this.x=window.innerWidth+this.w;this.y=randomIntFromInterval(20,600);this.z=4}spawn(){world.objects.push(new cloud)}draw(){ctx.drawImage(cloudImg,this.x,this.y,this.w,this.h)}}
class hill{constructor(a=null,b=null){this.type="hill";this.w=347*data.scale;this.h=641*data.scale;this.x=null!==a?a:window.innerWidth;this.y=null!==b?b:window.innerHeight-this.h-data.groundH+4;this.z=3}spawn(){world.objects.push(new hill)}draw(){ctx.drawImage(hillImg,this.x,this.y,this.w,this.h)}}
class tree{constructor(a=null,b=null){this.type="hill";this.w=201*data.scale;this.h=260*data.scale;this.x=null!==a?a:window.innerWidth;this.y=null!==b?b:window.innerHeight-this.h-data.groundH;this.z=2}spawn(){world.objects.push(new tree)}draw(){ctx.drawImage(treeImg,this.x,this.y,this.w,this.h)}}
class ground{constructor(a=null,b=null){this.type="ground";this.w=128*data.scale;this.h=128*data.scale;this.x=null!==a?a:window.innerWidth;this.y=null!==b?b:window.innerHeight-this.h;this.z=1}spawn(){world.objects.push(new ground)}draw(){ctx.drawImage(groundImg,this.x,this.y,this.w,this.h)}}
class plant{constructor(a=null,b=null){this.type="plant";this.w=46*data.scale;this.h=62*data.scale;this.x=null!==a?a:window.innerWidth;this.y=null!==b?b:window.innerHeight-this.h-data.groundH;this.z=1}spawn(){world.objects.push(new plant)}draw(){ctx.drawImage(plantImg,this.x,this.y,this.w,this.h)}}
class rock{constructor(a=null,b=null){this.type="rock";this.w=64*data.scale;this.h=38*data.scale;this.x=null!==a?a:window.innerWidth;this.y=null!==b?b:window.innerHeight-this.h-data.groundH;this.z=1}spawn(){world.objects.push(new rock)}draw(){ctx.drawImage(rockImg,this.x,this.y,this.w,this.h)}};const events=[{type:"delay",duration:60},{type:"speech-bubble",content:"Hi there!  I'm on my way to my office.",duration:120},{type:"speech-bubble",content:"The route I'm taking is dangerous though, so I'll need your help getting there.",duration:200},{type:"speech-bubble",content:"Maybe you'll get a high score!",duration:200},{type:"speech-bubble",content:"Oh, I'm Myles by the way.",duration:160},{type:"speech-bubble",content:"I specialize in making interactive websites, web apps and WordPress sites.",
duration:200},{type:"delay",duration:60},{type:"speech-bubble",content:"Oh no...  I was afraid of this...  Killer bats!!!",duration:140,complete:function(){data.continueEvents=!1;enemies.push(new Bat);setTimeout(function(){enemies.push(new Bat)},500);setTimeout(function(){enemies.push(new Bat)},1E3);let a=window.innerWidth/5/60*1E3+1E3;a=Math.floor(a);setTimeout(function(){data.continueEvents=!0;data.currentEvent+=1},a)}},{type:"speech-bubble",content:"Phew... Making websites can be dangerous!",duration:120},
{type:"speech-bubble",content:"Oh no... More bats!",duration:120,complete:function(){data.continueEvents=!1;enemies.push(new Bat);setTimeout(function(){enemies.push(new Bat)},500);setTimeout(function(){enemies.push(new Bat)},1E3);setTimeout(function(){enemies.push(new Bat)},1500);setTimeout(function(){enemies.push(new Bat)},2E3);setTimeout(function(){enemies.push(new Bat)},2500);let a=window.innerWidth/5/60*1E3+2500;a=Math.floor(a);setTimeout(function(){data.continueEvents=!0;data.currentEvent+=1},
a)}},{type:"speech-bubble",content:"Sheesh...",duration:90},{type:"speech-bubble",content:"Just a couple more minutes until I arrive.",duration:120},{type:"speech-bubble",content:"I have a feeling that's not all of the enemies we're going to see though.",duration:180},{type:"speech-bubble",content:"Oh, look.  There are some businesses I've worked with.",duration:180,complete:function(){world.objects.push({w:600*data.scale,h:341*data.scale,x:window.innerWidth,y:window.innerHeight-341*data.scale-data.groundH,
z:1,draw:function(){ctx.drawImage(ionOffice,this.x,this.y,this.w,this.h)}});setTimeout(function(){world.objects.push({w:600*data.scale,h:341*data.scale,x:window.innerWidth,y:window.innerHeight-341*data.scale-data.groundH,z:1,draw:function(){ctx.drawImage(iconOilOffice,this.x,this.y,this.w,this.h)}})},4500);setTimeout(function(){world.objects.push({w:600*data.scale,h:341*data.scale,x:window.innerWidth,y:window.innerHeight-341*data.scale-data.groundH,z:1,draw:function(){ctx.drawImage(jstBuilding,this.x,
this.y,this.w,this.h)}})},9E3);setTimeout(function(){world.objects.push({w:600*data.scale,h:341*data.scale,x:window.innerWidth,y:window.innerHeight-341*data.scale-data.groundH,z:1,draw:function(){ctx.drawImage(protonOffice,this.x,this.y,this.w,this.h)}})},13500)}},{type:"speech-bubble",content:"What!?!?  Attack drones!!!",duration:100,complete:function(){data.continueEvents=!1;enemies.push(new Ship);setTimeout(function(){enemies.push(new Ship)},500);let a=window.innerWidth/5/60*1E3+500;a=Math.floor(a);
setTimeout(function(){data.continueEvents=!0;data.currentEvent+=1},a)}},{type:"speech-bubble",content:"Oh no... The bats and attack drones have formed an alliance!",duration:180,complete:function(){data.continueEvents=!1;enemies.push(new Bat);setTimeout(function(){enemies.push(new Bat)},500);setTimeout(function(){enemies.push(new Bat)},1E3);setTimeout(function(){enemies.push(new Bat)},1500);setTimeout(function(){enemies.push(new Bat)},2E3);setTimeout(function(){enemies.push(new Ship)},3E3);setTimeout(function(){enemies.push(new Ship)},
4E3);let a=window.innerWidth/5/60*1E3+500;a=Math.floor(a);setTimeout(function(){data.continueEvents=!0;data.currentEvent+=1},a)}},{type:"spawn-enemy",spawn:function(){return new Ship(window.innerWidth,0)},duration:1},{type:"spawn-enemy",spawn:function(){return new Ship(window.innerWidth,window.innerHeight)},duration:1},{type:"delay",duration:180},{type:"spawn-enemy",spawn:function(){return new Ship(window.innerWidth,0)},duration:1},{type:"spawn-enemy",spawn:function(){return new Ship(window.innerWidth,
window.innerHeight)},duration:1},{type:"delay",duration:180},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,0)},duration:1},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/8)},duration:1},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/8*2)},duration:1},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/8*3)},duration:1},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,
window.innerHeight/8*4)},duration:1},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/8*5)},duration:1},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/8*6)},duration:1},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/8*7)},duration:1},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/8*8)},duration:1},{type:"delay",duration:300},{type:"spawn-enemy",
spawn:function(){return new Ship(window.innerWidth,0)},duration:1},{type:"spawn-enemy",spawn:function(){return new Ship(window.innerWidth,window.innerHeight)},duration:1},{type:"delay",duration:140},{type:"spawn-enemy",spawn:function(){return new Ship(window.innerWidth,0)},duration:1},{type:"spawn-enemy",spawn:function(){return new Ship(window.innerWidth,window.innerHeight)},duration:1},{type:"delay",duration:140},{type:"spawn-enemy",spawn:function(){return new Ship(window.innerWidth,0)},duration:1},
{type:"spawn-enemy",spawn:function(){return new Ship(window.innerWidth,window.innerHeight)},duration:1},{type:"delay",duration:300},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/2)},duration:1},{type:"delay",duration:15},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/2)},duration:1},{type:"delay",duration:15},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/2)},duration:1},
{type:"delay",duration:15},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/2)},duration:1},{type:"delay",duration:15},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/2)},duration:1},{type:"delay",duration:15},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/2)},duration:1},{type:"delay",duration:15},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/
2)},duration:1},{type:"delay",duration:15},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/2)},duration:1},{type:"delay",duration:15},{type:"spawn-enemy",spawn:function(){return new Bat(window.innerWidth,window.innerHeight/2)},duration:1},{type:"delay",duration:15},{type:"delay",duration:480},{type:"speech-bubble",content:"That was crazy!  Part of the job though.",duration:180},{type:"speech-bubble",content:"Anyway, we're pretty much there.",duration:120},
{type:"speech-bubble",content:"If you're looking for help building your next website or web app, we should talk!",duration:320},{type:"speech-bubble",content:'Click "Contact Me" to send a message.',duration:240},{type:"speech-bubble",content:"Here we are.  Thanks for your help!",duration:360,complete:function(){data.continueEvents=!1;world.objects.push({w:600*data.scale,h:341*data.scale,x:window.innerWidth,y:window.innerHeight-341*data.scale-data.groundH,z:1,draw:function(){ctx.drawImage(mylesOffice,
this.x,this.y,this.w,this.h)}});setTimeout(function(){data.gamePause=!0;data.gameComplete=!0;level1Music.fade(.8,0,1E3);(new Howl({src:["sounds/music/level-complete.wav"],volume:.7})).play();resetHero();$(".ui").animate({opacity:0});world.reset();player.reset();data.continueEvents=!1;(new bootstrap.Modal(document.getElementById("hs-modal"),{keyboard:!1})).show()},2500)}}];let dType=getDeviceType();
"desktop"===dType&&events.splice(3,0,{type:"speech-bubble",content:"Use your mouse to move and left click to attack.",duration:240});"mobile"===dType&&events.splice(3,0,{type:"speech-bubble",content:"Drag your finger across the screen to play.",duration:240});const world={gravity:1,groundH:128*data.scale,objects:[],events:[],ground:{spawnRate:25},hills:{spawnRate:560},trees:{spawnRate:320},clouds:{spawnRate:240},plants:{spawnRate:48},rocks:{spawnRate:64},reset:function(){data.continueEvents=!1;data.currentEvent=0;data.eventTimer=0;data.gamePause=!1;data.gameComplete=!0},update:function(){world.objects.sort(function(a,b){return a.z>b.z?-1:a.z>b.z?1:0});for(let a=0;a<world.objects.length;a++)1===world.objects[a].z&&(world.objects[a].x-=5*data.scale),2===
world.objects[a].z&&(world.objects[a].x-=4*data.scale),3===world.objects[a].z&&(world.objects[a].x-=3*data.scale),4===world.objects[a].z&&(world.objects[a].x-=2*data.scale),5===world.objects[a].z&&(world.objects[a].x-=1*data.scale);world.spawn();world.clean()},spawn:function(){0===data.frame%world.clouds.spawnRate&&(new cloud).spawn();0===data.frame%world.hills.spawnRate&&(new hill).spawn();0===data.frame%world.ground.spawnRate&&(new ground).spawn();0===data.frame%world.rocks.spawnRate&&1===randomIntFromInterval(1,
4)&&(new rock).spawn();0===data.frame%world.trees.spawnRate&&(new tree).spawn();0===data.frame%world.plants.spawnRate&&1===randomIntFromInterval(1,2)&&(new plant).spawn()},clean:function(){let a=[];for(var b=0;b<world.objects.length;b++)0>world.objects[b].x+world.objects[b].w&&a.push(b);for(b=0;b<a.length;b++)world.objects.splice(a[b],1)},draw:function(){for(var a=0;a<world.objects.length;a++)world.objects[a].draw();1>world.events.length||(!1===data.continueEvents||!0===data.gameComplete?document.querySelector(".speech-bubble-wrapper").style.display=
"none":(a=data.currentEvent,data.eventTimer<world.events[a].duration&&(data.eventTimer+=1),"speech-bubble"===world.events[a].type?(player.speak(world.events[a].content,1===data.eventTimer?!0:!1),data.eventTimer===world.events[a].duration&&"undefined"!==typeof world.events[a].complete&&world.events[a].complete()):document.querySelector(".speech-bubble-wrapper").style.display="none","spawn-enemy"===world.events[a].type&&enemies.push(world.events[a].spawn()),"spawn-object"===world.events[a].type&&world.objects.push(world.events[a].object),
data.eventTimer===world.events[a].duration&&(data.eventTimer=0,data.currentEvent<world.events.length&&(data.currentEvent+=1))))}};let groundW=126*data.scale,groundH=128*data.scale,count=window.innerWidth/groundW+1;count=Math.ceil(count);let x=0;for(let a=0;a<count;a++)world.objects.push(new ground(x,window.innerHeight-groundH)),x+=groundW;class effect{constructor(a="splat",b,c){data.id+=1;this.id=data.id;this.type=a;this.x=b;this.y=c;this.spriteCount=0;this.loop=!1;this.timer=120;this.sound()}brain(){--this.timer;0===this.timer&&this.remove()}remove(){const a=effects.findIndex(b=>b.id===this.id);effects.splice(a,1)}draw(){"splat"===this.type&&(ctx.drawImage(splat,139*this.spriteCount,0,139,120,this.x,this.y,139*data.scale,120*data.scale),10===this.spriteCount?this.remove():0===data.frame%3&&this.spriteCount++);"explosion"===this.type&&
(ctx.drawImage(explosion,130.5*this.spriteCount,0,130.5,120,this.x,this.y,130.5*data.scale,120*data.scale),6===this.spriteCount?this.remove():0===data.frame%3&&this.spriteCount++)}sound(a){"splat"===this.type&&(a=new Howl({src:["sounds/effects/splat.wav"]}),a.play());"explosion"===this.type&&(a=new Howl({src:["sounds/effects/explosion.wav"]}),a.play())}};anime({targets:".animate-hover",translateY:20,direction:"alternate",loop:!0,easing:"easeInOutSine"});var level1Music=new Howl({src:["sounds/music/level-1.mp3"],volume:.7,loop:!0});window.onscroll=function(){var a=document.querySelector("#canvas");!0===elementInView(a)?(data.gamePause=!1,level1Music.mute(!1)):(data.gamePause=!0,level1Music.mute(!0));a=document.querySelector("#canvas-water");!0===elementInView(a)?data.waterPause=!1:data.waterPause=!0};
document.querySelector(".ui-start-button").addEventListener("mousedown",function(){world.events=events;document.getElementById("hs-form-success").style.display="none";document.getElementById("hs-form-alert").style.display="none";document.getElementById("hs-form").style.display="block"});document.querySelector(".open-contact-modal").addEventListener("click",function(){anime({targets:".hero-content h1",opacity:1,display:"block",easing:"easeInOutQuad"})});
document.querySelector(".ui-start-button").addEventListener("click",function(){data.continueEvents=!0;data.gameComplete=!1;player.points=0;player.hp=100;(new Howl({src:["sounds/effects/start.wav"]})).play();level1Music.seek(0);level1Music.volume(.7);level1Music.play();$(".ui").animate({opacity:1});anime({targets:".hero-content h5",translateX:"1200px",opacity:0,easing:"easeInOutQuad"});anime({targets:".hero-content h1",translateX:"-1200px",opacity:0,easing:"easeInOutQuad",complete:function(){document.querySelector(".hero-content h1").style.display=
"none"}});anime({targets:".hero-content .ui-tooltip, .hero-content button",opacity:0,easing:"easeInOutQuad",complete:function(){document.querySelector(".hero-content .ui-tooltip, .hero-content button").style.display="none"}})});document.querySelector(".ui-weapon-laser").addEventListener("click",function(a){player.weapon=weapons.laser;player.spriteCount=0;document.querySelector(".ui-weapon-laser").classList.add("ui-button-active");document.querySelector(".ui-weapon-rocket").classList.remove("ui-button-active")});
document.querySelector(".ui-weapon-rocket").addEventListener("click",function(a){player.weapon=weapons.rocket;player.spriteCount=0;document.querySelector(".ui-weapon-rocket").classList.add("ui-button-active");document.querySelector(".ui-weapon-laser").classList.remove("ui-button-active")});let buttons=document.getElementsByClassName("ui-weapon-button");for(var i=0;i<buttons.length;i++)buttons[i].addEventListener("click",function(){(new Howl({src:["sounds/effects/weapon-change.wav"]})).play()},!1);
$(document).ready(function(){1200<window.innerWidth?$(".bxslider").bxSlider({pager:!1,minSlides:3,maxSlides:3,slideWidth:600}):1200>window.innerWidth&&767<window.innerWidth?$(".bxslider").bxSlider({pager:!1,minSlides:2,maxSlides:2,slideWidth:600}):$(".bxslider").bxSlider({pager:!1,minSlides:1,maxSlides:1,slideWidth:600})});document.querySelector("#canvas-water").addEventListener("mousemove",function(a){mouse.x=a.clientX;mouse.y=a.layerY});const allFish=[];for(let a=0;15>a;a++){let b=randomIntFromInterval(100,canvasWater.offsetWidth-100),c=randomIntFromInterval(200,canvasWater.offsetHeight-200),d=new Fish(b,c);allFish.push(d)}allFish.push(new Submarine(canvasWater.offsetWidth/2,canvasWater.offsetHeight/2));let device=getDeviceType();
function update(){!1===data.gamePause&&(document.getElementById("ui-hp").innerHTML=player.hp,document.getElementById("ui-lives").innerHTML=player.lives,document.getElementById("ui-points").innerHTML=player.points,ctx.clearRect(0,0,canvas.width,canvas.height),world.update(),world.draw(),doBrainAndDraw(enemies),doBrainAndDraw(player.projectiles),doBrainAndDraw(projectiles),doBrainAndDraw(effects),doBrainAndDraw(powerups),player.move(),player.draw());!1===data.waterPause&&(ctxWater.clearRect(0,0,canvasWater.width,
canvasWater.height),doBrainAndDraw(allFish));data.frame++}var stop=!1,frameCount=0,$results=$("#results"),fps,fpsInterval,startTime,now,then,elapsed;startAnimating(60);function startAnimating(a){fpsInterval=1E3/a;startTime=then=Date.now();animate()}function animate(){stop||(requestAnimationFrame(animate),now=Date.now(),elapsed=now-then,elapsed>fpsInterval&&(then=now-elapsed%fpsInterval,update()))};
